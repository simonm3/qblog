<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Simon Mackenzie">
<meta name="dcterms.date" content="2023-02-09">

<title>qblog - Understanding the heating in your home</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">qblog</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com"><i class="bi bi-twitter" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Understanding the heating in your home</h1>
  <div class="quarto-categories">
    <div class="quarto-category">home</div>
    <div class="quarto-category">analysis</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Simon Mackenzie </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 9, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="the-key-questions" class="level2">
<h2 class="anchored" data-anchor-id="the-key-questions">The key questions</h2>
<p>As gas prices soared I had some questions about my home energy usage:</p>
<ul>
<li>Why are my energy bills so high when I have most of the radiators switched off?</li>
<li>How can I reduce my energy usage?</li>
<li>When is it more effective to use electric heaters than gas central heating?</li>
</ul>
<p>To answer these questions I analysed how much energy my house should be using; how much is delivered by the central heating; and how the demand and supply are matched.</p>
<ol start="0" type="1">
<li>Introduction</li>
<li>Review of some key definitions</li>
<li>Demand for energy</li>
<li>Supply of energy</li>
<li>Matching demand and supply</li>
<li>Heating one room instead of the whole house</li>
<li>Warming the house</li>
<li>The answers</li>
</ol>
</section>
</section>
<section id="review-of-some-key-definitions" class="level1">
<h1>Review of some key definitions</h1>
<section id="what-is-power-and-energy" class="level2">
<h2 class="anchored" data-anchor-id="what-is-power-and-energy">What is power and energy?</h2>
<blockquote class="blockquote">
<p>Power (kw) = Energy (kwh) / Time (hours)</p>
</blockquote>
<p>Power is the rate at which energy is generated or used. It can be measured in Watts. A 100W lightbulb uses the same power as two 50W lightbulbs.</p>
<p>Energy is the amount of power used over a period of time. It can be measured in WattHours. So a 1 kw fire for one hour will require 1 kwh of energy. Sometimes different units are used e.g.&nbsp;Calories, Joules, Therms or BTUs. These can easily be converted to Kilowatt hours.</p>
<p>A kwh is exactly the same amount of energy whether it comes from electricity, gas or something else. So a 1 kwh electric fire and 1 kwh standalone, propane fire produce exactly the same amount of energy and heat the room at the same rate.</p>
</section>
<section id="what-is-efficiency" class="level2">
<h2 class="anchored" data-anchor-id="what-is-efficiency">What is efficiency?</h2>
<blockquote class="blockquote">
<p>energy_supplied = energy_used</p>
</blockquote>
<p>This is a law of physics. It is a zero sum game. If you input 1 kwh of energy then it will output 1 kwh of heat. Nothing is “used up”. However some of that energy may go into things other than what we want.</p>
<blockquote class="blockquote">
<p>efficiency = energy_used_for_what_we_want / energy_supplied</p>
</blockquote>
<p>Efficiency is the % of the input energy (kwh) that goes into heating your home to your desired temperature. When the room is the same temperature as outside then a 1 kw electric fire will inject 1 kwh of energy. As the room warms up energy will leak through the walls, ceiling, windows and floor. The heater is still supplying 1 kwh but more and more is used to just replace the leakage. Once the leakage reaches 1 kwh then the room won’t get any warmer.</p>
<p>Gas central heating has some additional inefficiencies - your boiler emits heat outside via the flue; your hot water pipes pass through the attic and expend some energy there.</p>
<blockquote class="blockquote">
<p>cost efficiency = energy_supplied_for_what_we_want / £_supplied</p>
</blockquote>
<p>The price of 1 kwh of electricity is three times that of 1 kwh of gas. Even though a gas boiler loses 15% to the flue it will still work out cheaper than electric heating in most cases.</p>
</section>
</section>
<section id="demand-for-energy" class="level1">
<h1>Demand for energy</h1>
<section id="leakage" class="level2">
<h2 class="anchored" data-anchor-id="leakage">leakage</h2>
<blockquote class="blockquote">
<p>Leakage watts = Area * U * deltaT</p>
</blockquote>
<p>Energy is leaked through walls, windows, floor and ceiling. That is it! Energy cannot be “used up” so it has to leave the room via one of these surfaces.</p>
<p>Area is the square metres of the surface. So the leakage is directly proportional to the area.</p>
<p>DeltaT is the difference between the room temperature and outside temperature. If it is 10C inside and 10C outside then leakage is zero. If you heat your house to the same temperature in each room then leakage through internal walls is zero; downstairs ceiling is zero; upstairs floor is zero. To maintain 20C room temperature when it temperature is 0C outside requires double the energy of when it is 10C outside as delta is 20 versus 10.</p>
<p>U varies according to the material and thickness. A typical wall will have layers of different material each of different materials and thickness. The U value represents how those materials conduct heat in aggregate. For a modern house U values are clearer than older houses where you may not know the materials used and they may have degraded over time. The table shows examples of typical U values:</p>
<p><img src="uvalues.png" class="img-fluid"></p>
<p>This shows:</p>
<ul>
<li>Modern homes are much more efficient than older homes
<ul>
<li>A new wall elimnates 50% of the leakage versus an uninsulated wall</li>
<li>A new window eliminates 80% of leakage versus a single glazed window</li>
<li>A new roof eliminates 90% of the leakage versus an uninsulated roof</li>
<li>A new floor eliminates 80% of the leakage from an uninsulated wooden floor</li>
</ul></li>
<li>Windows have five times the leakage per square metre versus walls</li>
<li>Floors are just as leaky as roofs. On an older house it is easy to insulate the roof. Once that is done the floor is leaking six times more heat than the roof. Many think that heat rises so the ceiling/roof is key. Actually it is not heat that rises but hot air. Unless you have holes in your ceiling the air will stay in the room. Therefore heat loss through the floor is just as critical as the roof. Unfortunately this can be hard to address on older properties.</li>
</ul>
</section>
<section id="ventilation" class="level2">
<h2 class="anchored" data-anchor-id="ventilation">ventilation</h2>
<blockquote class="blockquote">
<p>ventilation loss = .33 * Air changes per hour * Volume * deltaT</p>
</blockquote>
<p>If your home were air tight then you would suffocate. So there is some air coming in from outside through gaps under doors, vents and elsewhere. The leakage formula does not work here as U is infinite. The issue is how fast the air is coming in.</p>
<p>It is not clear how to estimate Air changes per hour (ACPH). I am using figures from Engineering toolbox who suggest .33 + .33 * number of external windows/doors. Multiple alternatives such as the OU suggest circa .5. Great_home suggest 1.5.</p>
<p>[Engineering Toolbox]<a href="https://www.engineeringtoolbox.com/air-change-rate-d_882.html" class="uri">https://www.engineeringtoolbox.com/air-change-rate-d_882.html</a> [Open University]<a href="https://www.open.edu/openlearn/nature-environment/energy-buildings/content-section-2.4.1" class="uri">https://www.open.edu/openlearn/nature-environment/energy-buildings/content-section-2.4.1</a></p>
</section>
<section id="example" class="level2">
<h2 class="anchored" data-anchor-id="example">example</h2>
<p>There is an online calculator to apply the formulae</p>
<p>[Online calculator]<a href="https://great-home.co.uk/radiator-sizing-guide-and-btu-calculator" class="uri">https://great-home.co.uk/radiator-sizing-guide-and-btu-calculator</a></p>
<p>I have adapted this using my own assumptions for a single room but there is a lot of guesswork:</p>
<ul>
<li>Cavity wall insulation is from 1935 so it may be low standard or have deteriorated</li>
<li>It is unclear what material is hidden in the floors, walls and ceiling following multiple extensions in different years</li>
<li>The attic is insulated but there are old metal tanks that conduct heat. Too big to fit through the rafters.</li>
<li>Unclear how to set ACPH. Used .7 but could be .5 or 1.5</li>
</ul>
<p><img src="office pie.png" class="img-fluid"></p>
<p>When temperature outside is -1C it requires slightly more than a 1 kw electric fire to maintain temperature in my office. The estimate of demand using the U value formula is 1.4K. This is in the right ballpark but could be 40% too high. Also it is very sensitive to the ACPH factor as 24% of energy loss is via ventilation.</p>
<p>Tried a bedroom as well. There are a few expected differences. Smaller room; upstairs demand is lower as an insulated ceiling is better than uninsulated floor; and windows upstairs are smaller but older. The biggest drivers are the size of room and ACPH. Other variations in characteristics seem to balance out. I have expanded the calculations for this room to the rest of the house based on room size only.</p>
<p>This gives total maintenance energy of 12kwh, 9kwh, 6.7kwh at -1C, 5C, 10C respectively. Heating the house from cold is in addition to this. My smart meter spikes when the heating goes on. The spike is because it has to heat the water from cold; and because the deltaT is over 20C so the kwh of the radiator is at its highest. After a few hours it stabilises at half the peak.</p>
</section>
</section>
<section id="supply-of-energy" class="level1">
<h1>Supply of energy</h1>
<section id="radiator-output" class="level2">
<h2 class="anchored" data-anchor-id="radiator-output">radiator output</h2>
<p>The table shows Stelrad radiator outputs. Other makes may vary but are likely similar. In general radiator suppliers quote outputs at delta T50. This means 50C difference between radiator and room temperature. The radiator temperature used is the average of input and output. For example input 75C, output 65C gives radiator 70C. With room at 20C that gives delta = 70-20 = 50C.</p>
<p>[Stelrad radiator guide]<a href="https://www.stelrad.com/wp-content/uploads/2018/05/27559_Stelrad-Spec-Brochure_August-2022_FLIPBOOK.pdf" class="uri">https://www.stelrad.com/wp-content/uploads/2018/05/27559_Stelrad-Spec-Brochure_August-2022_FLIPBOOK.pdf</a></p>
<p><img src="radiator outputs.png" class="img-fluid"></p>
<p>Setting the boiler to 60C gives T35 for spring and autumn temperatures Setting the boiler to 70C gives T45 for winter temperatures</p>
<p>To adapt from T50 to other T35 and T45:</p>
<blockquote class="blockquote">
<p>P = P50 * (tin-tout)/(ln(tin-ta)-ln(tout-ta))/49.32)^1.33</p>
</blockquote>
<p><img src="deltat conversion.png" class="img-fluid"></p>
</section>
</section>
<section id="matching-demand-and-supply" class="level1">
<h1>Matching demand and supply</h1>
<p>The table below shows how well my radiators meet the demand by room at external temperaatures of -1C, 5C, 10C with the boiler set to T35 and T45.</p>
<p><img src="utilisation.png" class="img-fluid"></p>
<p>The pink cells show where radiator supply is less than demand. Not that in this case demand means ability to maintain temperature only. Additional watts would be needed to warm the house in the first place.</p>
<p>The model suggests:</p>
<ul>
<li>60C is enough not enough for some rooms but is overall. In practice it is not enough for any rooms let alone overall.</li>
<li>70C is easily enough. Mostly this is true in practice as long as all the radiators are on</li>
</ul>
<p>Some rooms are very hard to estimate</p>
<ul>
<li>bedroom2 has a cupboard into the eves which is uninsulated. possibly could insulate or add draft excluder. It also has two external walls that face North.</li>
<li>Landing/Hall are open plan; uninsulated external door; likely drafts</li>
<li>Kitchen has to heat the utility room as well. This has boiler but no radiator and a door with single glazed glass. The adjacent morning room is needed to warm all three rooms</li>
</ul>
</section>
<section id="heating-one-room-instead-of-the-whole-house" class="level1">
<h1>Heating one room instead of the whole house</h1>
<section id="walls-floor-and-ceiling" class="level2">
<h2 class="anchored" data-anchor-id="walls-floor-and-ceiling">Walls, floor and ceiling</h2>
<p>To heat just the office means a temperature gap with the internal walls and ceiling which increases leakage. Assuming the unheated rooms are at 8C then this increases the demand from 1.4kwh to 2.2kwh. If the gap were 4C then it would be 2.6kwh. At 70C the radiator outputs 1.7kwh so may need to turn up the boiler. In practice I did not actually need to do this. Nevertheless the smart meter shows this one room costs not 2.6kwh but 8kwh; and five rooms with 11.5Kwh of radiators costs 15Kwh. So where does the missing 4-5kwh go?</p>
</section>
<section id="boiler" class="level2">
<h2 class="anchored" data-anchor-id="boiler">Boiler</h2>
<p>My boiler is 24kwh. The rated efficiency is 97% with condensing and 87% without. At 70/60 there is no condensing so the boiler is 87% efficient and the leak is 13% * 8000 = 1 kwh so there is a gap of 4.3kwh. For the five rooms the boiler flue loses 2kwh so there is a gap of 3.5kwh.</p>
<p>At lower temperature there is supposedly a cost saving of up to 10% from condensing. However condensing only starts to happen at the “dew point” and to get a 10% saving you would need a really low output from the boiler.</p>
<p><img src="dewpoint.png" class="img-fluid"></p>
<p>Even in the Spring the boiler output needs to be at least 60C output to heat the house. This would be around 50C return temperature and about 3% saving. Potentially you may get an additional saving whilst it is warming the water at startup and you have cold water coming back. However once the boiler is up and running the return temperature will be at least 50C. Any less and the house won’t warm up.</p>
<p>Still worth taking the 3% saving where you can. That means setting the boiler output temperature to 60C if the radiators are warm enough. I find this is only OK if the outside temperature is 5C+. Any less than that requires 70C to reach and maintain 20C inside the house. Even at 10C it is much faster to warm the house at 70C than 60C.</p>
</section>
<section id="pipes" class="level2">
<h2 class="anchored" data-anchor-id="pipes">Pipes</h2>
<p>Even though the radiators are all turned off the hot water is circulating around the whole system. If you are heating the whole house this does not matter even if the pipes are uninsulated because any heat from the pipes is inside the heated envelope and contributes to heating the rooms. In this case the pipes, often uninsulated, are carrying hot water through cold rooms.</p>
<p>A rough estimate is that the pipes go the length of the house plus width plus height. Times two because there is an outbound and return pipe. Could be more as the pipes may follow a circuitous route after extensions were build. This comes out as 65m of 22m pipe <span class="citation" data-cites="60W/m">@60W/m</span> plus say 10m of 15mm pipe <span class="citation" data-cites="45W/m">@45W/m</span>. Total leakage from pipes 4.3kw</p>
<p>This is close to the missing kw for single room heating. The five room heating loses a bit less as some pipes pass through heated rooms and any energy emitted supports the radiator.</p>
<p>Bottom line is that central heating is designed to heat the whole house and is efficient doing that. For a single room it is more cost effective to use a 1 kwh electric fire than 8kwh of gas. Heating five rooms with central heating costs 3kwh/room so equivalent cost to a 1 kw electric fire.</p>
<p>Note that this is based on a 260m2 house which is about double the average UK house size. Also an older house so not very efficient. It may not be the same for other houses.</p>
</section>
</section>
<section id="warming-up-the-house" class="level1">
<h1>Warming up the house</h1>
<p>All the above is just to maintain the temperature at the desired 20C. However unless the heating is on 24/7 we need to warm the house from cold at least once or twice a day. There are formulae to tell us the power required and the time it should take.</p>
<blockquote class="blockquote">
<p>Power to heat room = cp * density * volume * deltaT Time to heat room = Energy/Power / 60 minutes</p>
</blockquote>
<p>These formulae suggest my house should warm up in 20 minutes. It actually takes much longer. Unfortunately the time to heat the room does not take any account of leakage. When the room is cold there is not so much leakage. However as it warms the leakage increases and the power available gets soaked up by the leakage leaving less and less to heat the room. If the kwh supplied is too low then the room may never reach the target temperature.</p>
</section>
<section id="the-answers" class="level1">
<h1>The answers</h1>
<p>Based on the above we can answer the questions raised at the start</p>
<section id="why-are-my-energy-bills-so-high-when-i-have-most-of-the-radiators-switched-off" class="level2">
<h2 class="anchored" data-anchor-id="why-are-my-energy-bills-so-high-when-i-have-most-of-the-radiators-switched-off">Why are my energy bills so high when I have most of the radiators switched off?</h2>
<p>Central heating is designed to heat the whole house. If you only heat one or a few rooms then there is a lot of waste.</p>
<ol type="1">
<li>Turning the heating off means your room has gone from 2 external surfaces to 6. A typical room in a heated house leaks through one external wall plus ceiling upstairs or floor downstairs. Internal walls/floor/ceiling are similar temperature to the room so do not leak. If the heating is turned off then there are now leaks through four external walls; ceiling and floor. That is six external surfaces instead of two. Whilst the temperature difference is not as high as with outside there is still a big increase in leakage which requires more energy.</li>
<li>Hot water pipes flow throughout the whole house. If the heating is on then these are within the heated area and support the radiators in reaching the desired temperature. If the heating is off then this heat is lost. Furthermore it leaks at a much higher rate in cold rooms.</li>
<li>The boiler loses 13% through the flue. Condensing is supposed to save 10% but in practice this does not work well.</li>
</ol>
</section>
<section id="how-can-i-reduce-my-energy-usage" class="level2">
<h2 class="anchored" data-anchor-id="how-can-i-reduce-my-energy-usage">How can I reduce my energy usage?</h2>
<ol type="1">
<li>Add more insulation</li>
<li>Find any air gaps and fill them</li>
<li>Turn off the heating when you don’t need it. This includes when you are out and in Spring/Autumn</li>
</ol>
</section>
<section id="when-is-it-more-effective-to-use-electric-heaters-than-gas-central-heating" class="level2">
<h2 class="anchored" data-anchor-id="when-is-it-more-effective-to-use-electric-heaters-than-gas-central-heating">When is it more effective to use electric heaters than gas central heating?</h2>
<p>It is cheaper to use electric heating for up to four large rooms. Mostly this is because of heat lost via pipes in the cold rooms. In practice it is uncomfortable to walk through a cold hall to a cold kitchen. Therefore the electric heater solution is only feasible in limited circumstances such as working in an office all day or spending an evening watching TV.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>